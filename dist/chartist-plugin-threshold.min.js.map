{"version":3,"sources":["chartist-plugin-threshold.js"],"names":["root","factory","define","amd","returnExportsGlobal","exports","module","this","window","document","Chartist","createMasks","data","options","defs","svg","querySelector","elem","axisX","axis","axisY","projectedThresholdY","chartRect","height","projectValue","threshold","y2","projectedThresholdX","width","aboveThresholdY","aboveThresholdX","x","y","id","maskNames","aboveThreshold","fill","belowThreshold","projectedThreshold","defaultOptions","classNames","plugins","ctThreshold","extend","thresholdAxis","option","chart","Line","Bar","on","type","element","addClass","value","parent","_node","cloneNode","attr","mask"],"mappings":";;;;;;CAAC,SAAUA,EAAMC,GACO,kBAAXC,SAAyBA,OAAOC,IAEzCD,UAAW,WACT,MAAQF,GAAKI,oBAAsBH,MAET,gBAAZI,SAIhBC,OAAOD,QAAUJ,IAEjBD,EAAK,gCAAkCC,KAEzCM,KAAM,WAwHN,MAjHC,UAAUC,EAAQC,EAAUC,GAC3B,YAeA,SAASC,GAAYC,EAAMC,GAEzB,GAAIC,GAAOF,EAAKG,IAAIC,cAAc,SAAWJ,EAAKG,IAAIE,KAAK,QAGvDC,EAAyB,MAAjBL,EAAQM,KAChBC,EAAyB,MAAjBP,EAAQM,KAChBE,EAAsBD,EAAQR,EAAKU,UAAUC,SAAWX,EAAKQ,MAAMI,aAAaX,EAAQY,WAAab,EAAKU,UAAUI,GAAK,KACzHC,EAAsBT,EAAQN,EAAKU,UAAUM,QAAUhB,EAAKM,MAAMM,aAAaX,EAAQY,WAAY,KACnGI,EAAkBN,EAASF,EAC3BS,EAAkBF,EAAQD,EAC1BC,EAAQhB,EAAKG,IAAIa,QACjBL,EAASX,EAAKG,IAAIQ,QAoCtB,OAjCAT,GACGG,KAAK,QACJc,EAAG,EACHC,EAAG,EACHJ,MAAOA,EACPL,OAAQA,EACRU,GAAIpB,EAAQqB,UAAUC,iBAEvBlB,KAAK,QACJc,EAAG,EACHC,EAAG,EACHJ,MAAOD,GAAuBC,EAC9BL,OAAQF,GAAuBE,EAC/Ba,KAAM,UAIVtB,EACGG,KAAK,QACJc,EAAG,EACHC,EAAG,EACHJ,MAAOA,EACPL,OAAQA,EACRU,GAAIpB,EAAQqB,UAAUG,iBAEvBpB,KAAK,QACJc,EAAG,EACHC,EAAGM,mBACHV,MAAOV,EAAQY,EAAkBF,EACjCL,OAAQH,EAAQS,EAAkBN,EAClCa,KAAM,UAGHtB,EA7DT,GAAIyB,IACFpB,KAAM,IACNM,UAAW,EACXe,YACEL,eAAgB,qBAChBE,eAAgB,sBAElBH,WACEC,eAAgB,0BAChBE,eAAgB,2BAuDpB3B,GAAS+B,QAAU/B,EAAS+B,YAC5B/B,EAAS+B,QAAQC,YAAc,SAAU7B,GAEvCA,EAAUH,EAASiC,UAAWJ,EAAgB1B,EAE9C,IAAI+B,GAAiC,MAAhBC,OAAO1B,KAAgB,IAAM,GAElD,OAAO,UAAqB2B,IACtBA,YAAiBpC,GAASqC,MAAQD,YAAiBpC,GAASsC,OAC9DF,EAAMG,GAAG,OAAQ,SAAUrC,GACP,UAAdA,EAAKsC,KAGPtC,EAAKuC,QAAQC,SACXxC,EAAKyC,MAAMT,IAAkB/B,EAAQY,UAAYZ,EAAQ2B,WAAWL,eAAiBtB,EAAQ2B,WAAWH,gBAEnF,SAAdzB,EAAKsC,MAAiC,QAAdtC,EAAKsC,MAAgC,SAAdtC,EAAKsC,OAG7DtC,EAAKuC,QACFG,SACArC,KAAKL,EAAKuC,QAAQI,MAAMC,WAAU,IAClCC,MACCC,KAAM,QAAU7C,EAAQqB,UAAUC,eAAiB,MAEpDiB,SAASvC,EAAQ2B,WAAWL,gBAI/BvB,EAAKuC,QACFM,MACCC,KAAM,QAAU7C,EAAQqB,UAAUG,eAAiB,MAEpDe,SAASvC,EAAQ2B,WAAWH,mBAKnCS,EAAMG,GAAG,UAAW,SAAUrC,GAC5BD,EAAYC,EAAMC,SAK1BL,OAAQC,SAAUC,UAEbA,SAAS+B,QAAQC","file":"chartist-plugin-threshold.min.js","sourcesContent":["(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], function () {\n      return (root.returnExportsGlobal = factory());\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory();\n  } else {\n    root['Chartist.plugins.ctThreshold'] = factory();\n  }\n}(this, function () {\n\n  /**\n   * Chartist.js plugin to display a data label on top of the points in a line chart.\n   *\n   */\n  /* global Chartist */\n  (function (window, document, Chartist) {\n    'use strict';\n\n    var defaultOptions = {\n      axis: 'Y',\n      threshold: 0,\n      classNames: {\n        aboveThreshold: 'ct-threshold-above',\n        belowThreshold: 'ct-threshold-below'\n      },\n      maskNames: {\n        aboveThreshold: 'ct-threshold-mask-above',\n        belowThreshold: 'ct-threshold-mask-below'\n      }\n    };\n\n    function createMasks(data, options) {\n      // Select the defs element within the chart or create a new one\n      var defs = data.svg.querySelector('defs') || data.svg.elem('defs');\n      // x1,y1 = bottom left / x2,y2 = top right\n      // Project the threshold value on the chart Y axis\n      var axisX = options.axis === 'X';\n      var axisY = options.axis === 'Y';\n      var projectedThresholdY = axisY ? data.chartRect.height() - data.axisY.projectValue(options.threshold) + data.chartRect.y2 : null;\n      var projectedThresholdX = axisX ? data.chartRect.width() - data.axisX.projectValue(options.threshold): null;\n      var aboveThresholdY = height - projectedThresholdY;\n      var aboveThresholdX = width - projectedThresholdX;\n      var width = data.svg.width();\n      var height = data.svg.height();\n\n      // Create mask for part above threshold\n      defs\n        .elem('mask', {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          id: options.maskNames.aboveThreshold\n        })\n        .elem('rect', {\n          x: 0,\n          y: 0,\n          width: projectedThresholdX || width,\n          height: projectedThresholdY || height,\n          fill: 'white'\n        });\n\n      // Create mask for part below threshold\n      defs\n        .elem('mask', {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          id: options.maskNames.belowThreshold\n        })\n        .elem('rect', {\n          x: 0,\n          y: projectedThreshold,\n          width: axisX ? aboveThresholdX : width,\n          height: axisY ? aboveThresholdY : height,\n          fill: 'white'\n        });\n\n      return defs;\n    }\n\n    Chartist.plugins = Chartist.plugins || {};\n    Chartist.plugins.ctThreshold = function (options) {\n\n      options = Chartist.extend({}, defaultOptions, options);\n\n      var thresholdAxis = (option.axis === 'Y') ? 'y' : 'x';\n\n      return function ctThreshold(chart) {\n        if (chart instanceof Chartist.Line || chart instanceof Chartist.Bar) {\n          chart.on('draw', function (data) {\n            if (data.type === 'point') {\n              // For points we can just use the data value and compare against the threshold in order to determine\n              // the appropriate class\n              data.element.addClass(\n                data.value[thresholdAxis] >= options.threshold ? options.classNames.aboveThreshold : options.classNames.belowThreshold\n              );\n            } else if (data.type === 'line' || data.type === 'bar' || data.type === 'area') {\n              // Cloning the original line path, mask it with the upper mask rect above the threshold and add the\n              // class for above threshold\n              data.element\n                .parent()\n                .elem(data.element._node.cloneNode(true))\n                .attr({\n                  mask: 'url(#' + options.maskNames.aboveThreshold + ')'\n                })\n                .addClass(options.classNames.aboveThreshold);\n\n              // Use the original line path, mask it with the lower mask rect below the threshold and add the class\n              // for blow threshold\n              data.element\n                .attr({\n                  mask: 'url(#' + options.maskNames.belowThreshold + ')'\n                })\n                .addClass(options.classNames.belowThreshold);\n            }\n          });\n\n          // On the created event, create the two mask definitions used to mask the line graphs\n          chart.on('created', function (data) {\n            createMasks(data, options);\n          });\n        }\n      };\n    }\n  }(window, document, Chartist));\n\n  return Chartist.plugins.ctThreshold;\n\n}));\n"]}